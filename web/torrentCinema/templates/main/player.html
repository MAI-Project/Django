{% extends 'main/base.html' %}


{% block title %}
{{ title }}
{% endblock %}

{% block description %}
{{ film.name }}
{% endblock %}

{% block content %}
     <div class="myVideo" id="video">
        <!-- Include WebTorrent -->
    <script src="https://cdn.jsdelivr.net/npm/webtorrent@latest/webtorrent.min.js"></script>

    <!-- Torrent streaming -->
    <script>
        magnet = ""
        torrentId = "{{ film.magnet }}"
        for (var i = 0; i < torrentId.length; i++){
            if(torrentId[i] != '&'){
                magnet += torrentId[i]
            }
            else {
                magnet += '&'
                i+=4
            }
        }

        const client = new WebTorrent()
        client.add(magnet, onTorrent)

        // Render media files into to the page
        function onTorrent (torrent) {
            torrent.files.forEach(function (file) {
                if (file.name.endsWith('.mp4'))
                {
                    file.appendTo('.myVideo')
                }
            })
        }

    </script>
    </div>
    <footer class="footer-nongrad">
        <p>Â© 2022 813Enjoyers team
        </p>
    </footer>
{% endblock %}

